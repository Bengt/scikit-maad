.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download__auto_examples_using_shape_features.py>`     to download the full example code
    .. rst-class:: sphx-glr-example-title

    .. _sphx_glr__auto_examples_using_shape_features.py:


Using wavelets to characterize the time-frequency shape of sounds
=================================================================

@author:


.. code-block:: default

    from maad.sound import load, spectrogram
    from maad.features import shape_features, filter_bank_2d_nodc, opt_shape_presets, plot_shape
    from maad.util import format_rois, read_audacity_annot
    from maad.rois import overlay_rois
    import numpy as np

    s, fs = load('./data/spinetail.wav')
    rois_tf = read_audacity_annot('./data/spinetail.txt')  ## annotations using Audacity
    rois_cr = rois_tf.loc[rois_tf.label=='CRER',]  
    rois_sp = rois_tf.loc[rois_tf.label=='SP',]

    Sxx, ts, f, ext = spectrogram(s, fs)
    Sxx = np.log10(Sxx)

    # Visualize large vocalizations
    rois_bbox = format_rois(rois_cr, ts, f, fmt='bbox')
    overlay_rois(Sxx, ext, rois_bbox.values.tolist(), vmin=-16, vmax=0)

    # Visualize short vocalizations
    rois_bbox = format_rois(rois_sp, ts, f, fmt='bbox')
    overlay_rois(Sxx, ext, rois_bbox.values.tolist(), vmin=-16, vmax=0)

    # Compute an visualize features
    shape_cr, params = shape_features(Sxx, ts, f, resolution='high', rois=rois_cr)
    ax = plot_shape(shape_cr.mean(), params)

    shape_sp, params = shape_features(Sxx, ts, f, resolution='high', rois=rois_sp)
    ax = plot_shape(shape_sp.mean(), params)

    # visualize using t-SNE


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.000 seconds)


.. _sphx_glr_download__auto_examples_using_shape_features.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: using_shape_features.py <using_shape_features.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: using_shape_features.ipynb <using_shape_features.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
